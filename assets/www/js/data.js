/**
 * Created with JetBrains WebStorm.
 * User: Ian
 * Date: 27/08/12
 * Time: 10:46 AM
 * To change this template use File | Settings | File Templates.
 */
var data = {
  EYLF: {

    OutcomeOne: "Outcome One: Children have a strong sense of identity.",
    OutcomeTwo: "Outcome Two: Children are connected with and contribute to their world.",
    OutcomeThree: "Outcome Three: Children have a strong sense of well being.",
    OutcomeFour: "Outcome Four: Children are confident and involved learners.",
    OutcomeFive: "Outcome Five: Children are effective communicators.",

    OutcomeOneA: ["Children feel safe, secure and supported","build secure attachments with one and then more familiar educators", "use effective routines to help make predicted transitions smoothly", "sense and respond to a feeling of belonging, communicate their needs for comfort and assistance", "establish and maintain respectful, trusting relationships with other children and educators", "openly express their feelings and ideas in their interactions with others", "respond to ideas and suggestions from others", "initiate interactions and conversations with trusted educators", "confidently explore and engage with social and physical environments through relationships and play", "initiate and join in play", "explore aspects of identity through role play"],
    OutcomeOneB: ["Children develop their emerging autonomy,inter-dependence, resilience and sense of agency","demonstrate increasing awareness of the needs and rights of others","be open to new challenges and discoveries","increasingly co-operate and work collaboratively with others ", "take considered risk in their decision-making and cope with the unexpected","recognise their individual achievements and the achievements of others", "demonstrate an increasing capacity for self-regulation","approach new safe situations with confidence", "begin to initiate negotiating and sharing  behaviours", "persist when faced with challenges and when first attempts are not successful"],
    OutcomeOneC: ["Children develop knowledgeable and confident self identities","feel recognised and respected for who they are", "explore different identities and points of view in dramatic play", "share aspects of their culture with the other children and educators", "use their home language to construct meaning", "develop strong foundations in both the culture and language/s of their family and of the broader community without compromising their cultural identities", "develop their social and cultural heritage through engagement with Elders and community members", "reach out and communicate for comfort, assistance and companionship", "celebrate and share their contributions and achievements with others"],
    OutcomeOneD: ["Children learn to interact in relation to others with care, empathy and respect","show interest in other children and being part of a group ", "engage in and contribute to shared play experiences","express a wide range of emotions, thoughts and views constructively ", "empathise with and express concern for others ", "display awareness of and respect for others’ perspectives", "reflect on their actions and consider consequences for others"],

    OutcomeTwoA: ["Children develop a sense of belonging to groups and communities and an understanding of the reciprocal rights and responsibilities necessary for active community participation","begin to recognise that they have a right to belong to many communities", "cooperate with others and negotiate roles and relationships in play episodes and group experiences", "take action to assist other children to participate in social groups", "broaden their understanding of the world in which they live", "express an opinion in matters that affect them", "build on their own social experiences to explore other ways of being", "participate in reciprocal relationships", "gradually learn to ‘read’ the behaviours of others and respond appropriately", "understand different ways of contributing through play and projects", "demonstrate a sense of belonging and comfort in their environments", "are playful and respond positively to others, reaching out for company and friendship", "contribute to fair decision-making about matters that affect them"],
    OutcomeTwoB: ["Children respond to diversity with respect","begin to show concern for others", "explore the diversity of culture, heritage, background and tradition and that diversity presents opportunities for choices and new understandings","become aware of connections, similarities and differences between people","listen to others’ ideas and respect different ways of being and doing", "practise inclusive ways of achieving coexistence", "notice and react in positive ways to similarities and differences among people" ],
    OutcomeTwoC: ["Children become aware of fairness ","discover and explore some connections amongst people","become aware of ways in which people are included or excluded from physical and social environments","develop the ability to recognise unfairness and bias and the capacity to act with compassion and kindness","are empowered to make choices and problem solve to meet their needs in particular contexts", "begin to think critically about fair and unfair behaviour","begin to understand and evaluate ways in which texts construct identities and create stereotypes"],
    OutcomeTwoD: ["Children become socially responsible and show respect for the environment","use play to investigate, project and explore new ideas","participate with others to solve problems and contribute to group outcomes","demonstrate an increasing knowledge of, and respect for natural and constructed environments","explore, infer, predict and hypothesise in order to develop an increased understanding of the interdependence between land, people, plants and animals","show growing appreciation and care for natural and constructed environments","explore relationships with other living and non-living things and observe, notice and respond to change","develop an awareness of the impact of human activity on environments and the interdependence of living things"],

    OutcomeThreeA: ["Children become strong in their social and emotional wellbeing","demonstrate trust and confidence","remain accessible to others at times of distress, confusion and frustration","share humour, happiness and satisfaction seek out and accept new challenges, make new discoveries, and celebrate their own efforts and achievements and those of others","increasingly co-operate and work collaboratively with others","enjoy moments of solitude","recognise their individual achievement", "make choices, accept challenges, take considered risks, manage change and cope with frustrations and the unexpected", "show an increasing capacity to understand, self-regulate and manage their emotions in ways that reflect the feelings and needs of others", "experience and share personal successes in learning and initiate opportunities for new learning in their home languages or Standard Australian English", "acknowledge and accept affirmation", "assert their capabilities and independence while demonstrating increasing awareness of the needs and rights of others","recognise the contributions they make to shared projects and experiences "],
    OutcomeThreeB: ["Children take increasing responsibility for their own health and physical wellbeing","recognise and communicate their bodily needs (for example, thirst, hunger, rest, comfort, physical activity)","are happy, healthy, safe and connected to others", "engage in increasingly complex sensory- motor skills and movement patterns", "combine gross and fine motor movement and balance to achieve increasingly complex patterns of activity including dance, creative movement and drama", "use their sensory capabilities and dispositions with increasing integration, skill and purpose to explore and respond to their world", "demonstrate spatial awareness and orient themselves, moving around and through their environments confidently and safely", "manipulate equipment and manage tools with increasing competence and skill", "respond through movement to traditional and contemporary music, dance and storytelling", "show an increasing awareness of healthy lifestyles and good nutrition", "show increasing independence and competence in personal hygiene, care and safety for themselves and others", "show enthusiasm for participating in physical play and negotiate play spaces to ensure the safety and wellbeing of themselves and others"],

    OutcomeFourA: ["Children develop dispositions for learning such as curiosity, cooperation, confidence, creativity, commitment, enthusiasm, persistence, imagination and reflexivity ","express wonder and interest in their environments","are curious and enthusiastic participants in their learning","use play to investigate, imagine and explore ideas", "follow and extend their own interests with enthusiasm, energy and concentration", "initiate and contribute to play experiences emerging from their own ideas", "participate in a variety of rich and meaningful inquiry-based experiences","persevere and experience the satisfaction of achievement", "persist even when they find a task difficult "],
    OutcomeFourB: ["Children develop a range of skills and processes such as problem solving, enquiry, experimentation, hypothesising, researching and investigating","apply a wide variety of thinking strategies to engage with situations and solve problems, and adapt these strategies to new situations","create and use representation to organise, record and communicate mathematical ideas and concepts","make predictions and generalisations about their daily activities, aspects of the natural world and environments, using patterns they generate or identify and communicate these using mathematical language and symbols","explore their environment","manipulate objects and experiment with cause and effect, trial and error, and motion","contribute constructively to mathematical discussions and arguments","use reflective thinking to consider why things happen and what can be learnt from these experiences"],
    OutcomeFourC: ["Children transfer and adapt what they have learned from one context to another","engage with and co-construct learning","develop an ability to mirror, repeat and practice the actions of others, either immediately or later","make connections between experiences, concepts and processes","use the processes of play, reflection and investigation to solve problems","apply generalisations from one situation to another","try out strategies that were effective to solve problems in one situation in a new context","transfer knowledge from one setting to another"],
    OutcomeFourD: ["Children resource their own learning through connecting with people, place, technologies and natural and processed materials","engage in learning relationships ","use their senses to explore natural and built environments","experience the benefits and pleasures of shared learning exploration",        "explore the purpose and function of a range of tools, media, sounds and graphics",        "manipulate resources to investigate, take apart, assemble, invent and construct",        "experiment with different technologies use information and communication technologies (ICT) to  investigate and problem solve",        "explore ideas and theories using imagination, creativity and play", "use feedback from themselves and others to revise and build on an idea"],

    OutcomeFiveA: ["Children interact verbally and non-verbally with others for a range of purposes","engage in enjoyable interactions using verbal and non-verbal language ",        "convey and construct messages with purpose and confidence, building on home/family and community literacies",        "respond verbally and non-verbally to what they see, hear, touch, feel and taste",        " use language and representations from play, music and art to share and project meaning",        " contribute their ideas and experiences in play, small and large group discussions",        "   attend and give cultural cues that they are listening to and understanding what is said to them",        "are independent communicators who initiate Standard Australian English and home language conversations and demonstrate the ability to meet the listeners’ needs",        "interact with others to explore ideas and concepts, clarify and challenge thinking, negotiate and share new understandings",        "convey and construct messages with purpose and confidence, building on literacies of home/family and the broader community",        "exchange ideas, feelings and understandings using language and representations in play",        "demonstrate an increasing understanding of measurement and number using vocabulary to describe size, length, volume, capacity and names of numbers",        "express ideas and feelings and understand and respect the perspectives of others",        "use language to communicate thinking about quantities to describe attributes of objects and collections, and to explain mathematical ideas","show increasing knowledge, understanding and skill in conveying meaning in at least one language"],
    OutcomeFiveB: ["Children engage with a range of texts and gain meaning from these texts","listen and respond to sounds and patterns in speech, stories and rhymes in context",        "view and listen to printed, visual and multimedia texts and respond with relevant gestures, actions, comments and/or questions",        "sing and chant rhymes, jingles and songs",        "take on roles of literacy and numeracy users in their play",        "begin to understand key literacy and numeracy concepts and processes, such as the sounds of language, letter-sound relationships, concepts of print and the ways that texts are structured",        "explore texts from a range of different perspectives and begin to analyse the meanings",        "actively use, engage with and share the enjoyment of language and texts in a range of ways",        "recognise and engage with written and oral culturally constructed texts "],
    OutcomeFiveC: ["Children express ideas and make meaning using a range of media","use language and engage in play to imagine and create roles, scripts and ideas",        "share the stories and symbols of their own culture and re-enact well-known stories",        "use the creative arts such as drawing, painting, sculpture, drama, dance, movement, music and storytelling to express ideas and make meaning",        "experiment with ways of expressing ideas and meaning using a range of media",        "begin to use images and approximations of letters and words to convey meaning "],
    OutcomeFiveD: ["Children begin to understand how symbols and pattern systems work","use symbols in play to represent and make meaning",        "begin to make connections between and see patterns in their feelings, ideas, words and actions and those of others",        "notice and predict the patterns of regular routines and the passing of time",        "develop an understanding that symbols are a powerful means of communication and that ideas, thoughts and concepts can be represented through them",        "begin to be aware of the relationships between oral, written and visual representations",        "begin to recognise patterns and relationships and the connections between them",        "begin to sort, categorise, order and compare collections and events and attributes of objects and materials, in their social and natural worlds",        "listen and respond to sounds and patterns in speech, stories and rhyme",        "draw on memory of a sequence to complete a task",        "draw on their experiences in constructing meaning using symbols "],
    OutcomeFiveE: ["Children use information and communication technologies to access information, investigate ideas and represent their thinking","identify the uses of technologies in everyday life and use real or imaginary technologies as props in their play",        "use information and communication technologies to access images and information, explore diverse perspectives and make sense of their world",        "use information and communication technologies as tools for designing, drawing, editing, reflecting and composing",      "engage with technology for fun and to make meaning"]
  },

    QKLG: {
        OutcomeOne: "Identity - A kindergarten child who has a strong sense of identity.",
        OutcomeTwo: "Connectedness - A kindergarten child who is connected with and contributes to their world.",
        OutcomeThree: "Wellbeing - A kindergarten child who has a strong sense of wellbeing.",
        OutcomeFour: "Active Learning - A kindergarten child who is a confident and involved learner.",
        OutcomeFive: "Communicating - A kindergarten child who is an effective communicator.",

        OutcomeOneA: ["Is building a sense of security and trust","a sense of being safe, accepted and supported","a sense of belonging and confidence in others"],
        OutcomeOneB: ["Acts with increasing independence and perseverance","organising self and belongings and managing routines","making choices","willingness to keep trying"],
        OutcomeOneC: ["Is building a confident self-identity","pride and confidence in who they are, their family and culture","pride and confidence in their strengths and abilities","confidence in themselves as a learner"],

        OutcomeTwoA: ["Is building positive relationships with others","skills for connecting with and relating to others","awareness of own and others’ rights and responsibilities","understandings about fairness"],
        OutcomeTwoB: ["Shows increasing respect for diversity","ways to respond to others with respect","interest in their own culture and others’ cultures and heritages","exploring aspects of culture and similarities and differences among people","awareness of bias and stereotyping"],
        OutcomeTwoC: ["Shows increasing respect for environments","caring for and respecting environments","ways to investigate and understand natural and built environments","exploring interactions between people and environments"],

        OutcomeThreeA: ["Is building a sense of autonomy and wellbeing","delight in making decisions and choices (agency)","courage and resilience to manage change and challenges","ways to understand and regulate emotions"],
        OutcomeThreeB: ["Explores ways to show care and concern and interact positively with others","interest in and desire to interact with others","considering and empathising with others"],
        OutcomeThreeC: ["Explores ways to promote own and others’ health and safety","ways to manage personal hygiene and self-care","ways to stay healthy and safe"],
        OutcomeThreeD: ["Explores ways to promote physical wellbeing","control and strength for manipulating objects, tools and equipment","large movement skills, movement control, coordination and strength","confidence to engage in movement challenges"],

        OutcomeFourA: ["Is building positive dispositions and approaches toward learning","enthusiasm for learning and curiosity","problem solving and investigating","applying and reflecting on learning"],
        OutcomeFourB: ["Shows increasing confidence and involvement in learning","confidence, interest and involvement in learning","making choices and organising resources for learning","ways to contribute to learning conversations"],
        OutcomeFourC: ["Engages in ways to be imaginative and creative","a sense of wonder, imagination and creativity","ways to creatively represent ideas, feelings and experiences"],
        OutcomeFourD: ["Explores tools, technologies and information and communication technologies (ICTs)","using tools and technologies in play and active learning","using information and communication technologies for a range of purposes"],

        OutcomeFiveA:["Explores and expands ways to use language","spoken and nonverbal communication","age-appropriate speech patterns, vocabulary and sentence structures","using language for a range of purposes","skills for listening and taking turns in conversations"],
        OutcomeFiveB:["Explores and engages with literacy in personally meaningful ways","positive engagement with a variety of print and multimedia texts and the arts","exploring symbols and patterns in language","exploring text purposes and meanings","confidence and interest in exploring reading and writing behaviours"],
        OutcomeFiveC:["Explores and engages with numeracy in personally meaningful ways", "exploring number symbols and their purposes","confidence and interest in counting and exploring patterns and relationships","exploring mathematical thinking, concepts and language"]
    },

    PREP: {
        OutcomeOne: "Number and Place Value - Establish understanding of the language and processes of counting by naming numbers in sequences, initially to and from 20, moving from any starting point",
        OutcomeTwo: "Number and Place Value - Connect number names, numerals and quantities, including zero, initially up to 10 and then beyond.",
        OutcomeThree: "Number and Place Value - Subitise small collections of objects.",
        OutcomeFour: "Number and Place Value - Compare, order and make correspondences between collections, initially to 20, and explain reasoning.",
        OutcomeFive: "Number and Place Value - Represent practical situations to model addition and sharing."
    }


}

//data["EYLF"]["OutcomeOneA"].indexOf("")

function PrepData() {

    $.mobile.allowCrossDomainPages = true;

    uploadingPhoto();

    var tests = ["OutcomeOne", "OutcomeTwo", "OutcomeThree","OutcomeFour","OutcomeFive"]
    var outcomes = ReportOutcomes;

    SendData.outcomes = {};

    for(var i = 0; i<outcomes.length;i++) {
        outcomes[i] = outcomes[i].trim();
        for(var oc in data[ReportType]) {

            var index = data[ReportType][oc].indexOf(outcomes[i]);

            if(index != -1) {
                    var title = "";

                    for(var j = 0; j<tests.length; j++) {
                        var re = new RegExp(tests[j], 'g');
                        var match = oc.match(re)
                        if(match) {
                            title = data[ReportType][tests[j]];
                            j = tests.length;
                        }
                    }


                    if(SendData.outcomes[match[0]]) {
                            if(!SendData.outcomes[match[0]][oc]) { SendData.outcomes[match[0]][oc] = {}; }
                        SendData.outcomes[match[0]].Title = title;
                    }
                    else {
                        SendData.outcomes[match[0]] = {};
                        SendData.outcomes[match[0]][oc] = {};
                        SendData.outcomes[match[0]].Title = data[ReportType][match[0]];
                    }

                if(index == 0) {
                    SendData.outcomes[match[0]][oc].Descriptor = data[ReportType][oc][index];
                }
                else {
                    if(SendData.outcomes[match[0]][oc].Selections) {
                        SendData.outcomes[match[0]][oc].Selections.push(data[ReportType][oc][index])
                    }
                    else {
                        SendData.outcomes[match[0]][oc].Selections = [];
                        SendData.outcomes[match[0]][oc].Selections.push(data[ReportType][oc][index])
                    }
                }
            }
        }
    }


    if(window.Prototype) {
        delete Object.prototype.toJSON;
        delete Array.prototype.toJSON;
        delete Hash.prototype.toJSON;
        delete String.prototype.toJSON;
    }


    TryUploadImages();
}

function TryUploadImages() {

    if(SendData.imageData.length > 0) {

        uploadingPhoto();
        var cImage = SendData.imageData.pop();
        var cCaption = SendData.captionData.pop();
        var options = new FileUploadOptions();
        options.fileKey="file";
        options.fileName=cImage.substr(cImage.lastIndexOf('/')+1);
        options.mimeType="image/jpeg";
        options.SendData = SendData;
        options.uuid = SendData.uuid;
        options.chunkedMode = false;
        var params = new Object();
        params.uuid = SendData.uuid;
		params.email = SendData.email;
		params.name = options.fileName;
        options.params = params;
        options.chunkedMode = false;

        var ft = new FileTransfer();
        ft.upload(cImage, "http://ec2-23-22-186-167.compute-1.amazonaws.com/school/upload",UploadImageSuccess, UploadImageFail, options);
        //ft.upload(cImage, "http://localhost:10080/school/upload",UploadImageSuccess, UploadImageFail, options);
    }
    else {
        uploadPhotoCB();
        TryUploadData();
    }
}


function TryUploadData() {

    uploadingPhoto();

    var emailObj = new Email(SendData.title, SendData.date, SendData.images, SendData.captions, SendData.notes, SendData.followupexperience, SendData.evaluation, SendData.type, SendData.Background, SendData.Font, SendData.template, SendData.outcomes, SendData.FontColour, SendData.principles, SendData.practices);
    var emailString = emailObj.GenerateEmail(SendData.template);

    //emailString = "<html xmlns='http://www.w3.org/1999/html'> <head> <meta charset='utf-8'> <title>Learning Story</title> </head> <body><div style='width:600px;font-family:helvetica;border-radius: 5px;-moz-border-radius: 5px;-webkit-border-radius: 5px;border: 2px solid #E8EDFF;display:table'> <!-- Title Banner --> <div style='width:600px;height:60px;float:left;color:black;text-align:center;background-image: -ms-linear-gradient(bottom, #FFFFFF 0%, #00A3EF 100%);background-image: -moz-linear-gradient(bottom, #FFFFFF 0%, #00A3EF 100%);background-image: -o-linear-gradient(bottom, #FFFFFF 0%, #00A3EF 100%);background-image: -webkit-gradient(linear, left bottom, left top, color-stop(0, #FFFFFF), color-stop(1, #00A3EF));background-image: -webkit-linear-gradient(bottom, #FFFFFF 0%, #00A3EF 100%);background-image: linear-gradient(to top, #FFFFFF 0%, #00A3EF 100%);'>    <span style='font-size:28px;width:600px;float:left;'>Learning Story</span>     <span style='width:600px;font-style:italic;float:left;'>12/12/12</span> </div><div style='width:600px;height:200px;float:left;margin-top:10px'><img src='cid:a.jpg' width='193' height='200' style='border:none;margin:0px 10px 0px 105px;float:left;'><img src='cid:b.jpg' width='193' height='200' style='border:none;margin:0px 0px 0px 0px;float:left;'></div><div style='width:600px;height:20px;float:left;'><div style='width:193px;margin-left:105px;float:left;text-align:center;font-style:italic;font-size:10px'>asd asdasd</div><div style='width:193px;float:left;text-align:center;font-style:italic;font-size:10px'>zxczxczxc</div></div><!-- Text Container --><div style='width:600px;float:left;margin-top:10px'><div style='width:193px;float:left;margin:0px 10px 0px 0px;'><p style='text-align:center;font-weight:bold'>Evaluation</p><p style='font-size:12px'>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p><p style='text-align:center;font-weight:bold'>Follow-Up Experience</p><p style='font-size:12px'>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p></div><div style='width:193px;float:left;margin:0px 0px 0px 0px;'><p style='text-align:center;font-weight:bold'>Learning Outcomes</p><ul style='font-size:12px'><li style='margin-bottom: 1em;'>Outcome One: Children have a strong sense of identity. Children feel safe, secure and supported - build secure attachments with one and then more familiar educators,  use effective routines to help make predicted transitions smoothly. </br></br></li><li style='margin-bottom: 1em;'>Outcome Two: Children are connected with and contribute to their world. Children respond to diversity with respect - begin to show concern for others,  explore the diversity of culture, heritage, background and tradition and that diversity presents opportunities for choices and new understandings,  become aware of connections, similarities and differences between people. </br></br></li></ul></div></div></div></body></html>";
    if(SendData.cc == null) { SendData.cc = ""; }

    $.ajax({
        url: "http://ec2-23-22-186-167.compute-1.amazonaws.com/school/content",
        //url: "http://localhost:10080/school/content",
        type: "POST",
        data: JSON.stringify({uuid: SendData.uuid, cc:SendData.cc, to:SendData.email, body: emailString}),

        cache: false,
        success: function(response, status, obj){
            uploadPhotoCB();
            alert("Report Submitted");
            if(ReportTerm == 0 || ReportTerm == "Other" ) {

            }
            else {
                CallbackData = 1;
                UpdateStudentTermCB(CurrentStudent.name)
            }
        },
        error: function(obj) {
            uploadPhotoCB();
        }
    });
}

function UploadImageFail() {
    uploadPhotoCB();
    alert("Image could not be uploaded. Please ensure you have an active internet connection");
}

function UploadImageSuccess(r) {

    uploadPhotoCB();
    TryUploadImages();
}



function uploadingPhoto(){
    $("body").append('<div class="modalWindow"/>');
    $.mobile.showPageLoadingMsg();
}

function uploadPhotoCB(){
    $(".modalWindow").remove();
    $.mobile.hidePageLoadingMsg();

}



//var SendDataFormat = {

 //   Type: "EYLF",
 //   Title: "",
 //   Date: "",


//}